"use strict";(()=>{var t={};t.id=223,t.ids=[223],t.modules={145:t=>{t.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},9926:t=>{t.exports=import("zod")},1455:(t,e,a)=>{a.a(t,async(t,r)=>{try{a.r(e),a.d(e,{config:()=>u,default:()=>c,routeModule:()=>l});var n=a(1802),o=a(7153),s=a(6249),i=a(5594),d=t([i]);i=(d.then?(await d)():d)[0];let c=(0,s.l)(i,"default"),u=(0,s.l)(i,"config"),l=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/posts",pathname:"/api/posts",bundlePath:"",filename:""},userland:i});r()}catch(t){r(t)}})},9822:(t,e,a)=>{a.d(e,{Z:()=>s});let r=require("@prisma/client"),n=globalThis,o=n.prisma||new r.PrismaClient,s=o},5594:(t,e,a)=>{a.a(t,async(t,r)=>{try{a.r(e),a.d(e,{default:()=>handler});var n=a(9822),o=a(9926),s=t([o]);o=(s.then?(await s)():s)[0];let i=o.z.object({content:o.z.string().min(1),authorId:o.z.string().optional()});async function handler(t,e){if("GET"===t.method){let t=await n.Z.post.findMany({include:{comments:!0,author:!0},orderBy:{createdAt:"desc"}});e.status(200).json(t);return}if("POST"===t.method){let a=i.safeParse(t.body);if(!a.success)return e.status(400).json({error:a.error.flatten()});try{let t=a.data,r=await n.Z.post.create({data:{content:t.content,author:t.authorId?{connect:{id:t.authorId}}:void 0}});e.status(201).json(r);return}catch(t){e.status(500).json({error:String(t)})}}e.status(405).json({error:"method not allowed"})}r()}catch(t){r(t)}})}};var e=require("../../webpack-api-runtime.js");e.C(t);var __webpack_exec__=t=>e(e.s=t),a=e.X(0,[222],()=>__webpack_exec__(1455));module.exports=a})();