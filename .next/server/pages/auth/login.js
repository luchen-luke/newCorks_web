"use strict";(()=>{var e={};e.id=344,e.ids=[344,660],e.modules={6199:(e,t,r)=>{r.r(t),r.d(t,{config:()=>f,default:()=>S,getServerSideProps:()=>x,getStaticPaths:()=>b,getStaticProps:()=>m,reportWebVitals:()=>_,routeModule:()=>q,unstable_getServerProps:()=>k,unstable_getServerSideProps:()=>y,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>P,unstable_getStaticProps:()=>v});var a={};r.r(a),r.d(a,{default:()=>Login});var s=r(7093),o=r(5244),n=r(1323),i=r(9209),l=r.n(i),u=r(9597),d=r(997),c=r(8933),p=r(6689),g=r(1163),h=r(7159);function Login(){let[e,t]=(0,p.useState)(""),[r,a]=(0,p.useState)(""),s=(0,h.a)(),o=(0,g.useRouter)();async function submit(){let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:e,password:r})}),a=await t.json();t.ok?(s.login(a.token,a.user),o.push("/")):alert(JSON.stringify(a))}return(0,d.jsxs)(c.Z,{children:[d.jsx("h2",{children:"登录"}),(0,d.jsxs)("div",{className:"card",children:[d.jsx("input",{placeholder:"邮箱或手机号",value:e,onChange:e=>t(e.target.value),style:{width:"100%",padding:8,borderRadius:8,marginBottom:8}}),d.jsx("input",{placeholder:"密码",type:"password",value:r,onChange:e=>a(e.target.value),style:{width:"100%",padding:8,borderRadius:8,marginBottom:8}}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx("button",{className:"btn",onClick:submit,children:"登录"})})]})]})}let S=(0,n.l)(a,"default"),m=(0,n.l)(a,"getStaticProps"),b=(0,n.l)(a,"getStaticPaths"),x=(0,n.l)(a,"getServerSideProps"),f=(0,n.l)(a,"config"),_=(0,n.l)(a,"reportWebVitals"),v=(0,n.l)(a,"unstable_getStaticProps"),P=(0,n.l)(a,"unstable_getStaticPaths"),j=(0,n.l)(a,"unstable_getStaticParams"),k=(0,n.l)(a,"unstable_getServerProps"),y=(0,n.l)(a,"unstable_getServerSideProps"),q=new s.PagesRouteModule({definition:{kind:o.x.PAGES,page:"/auth/login",pathname:"/auth/login",bundlePath:"",filename:""},components:{App:u.default,Document:l()},userland:a})},7159:(e,t,r)=>{r.d(t,{a:()=>useAuth});var a=r(6689);function useAuth(){let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=localStorage.getItem("corks_token");e&&(t(e),fetch("/api/auth/me",{headers:{Authorization:"Bearer "+e}}).then(e=>e.json()).then(e=>{e&&!e.error&&s(e)}))},[]),{token:e,user:r,login:function(e,r){localStorage.setItem("corks_token",e),t(e),s(r)},logout:function(){localStorage.removeItem("corks_token"),t(null),s(null)}}}},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},9955:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[209,130,424,909],()=>__webpack_exec__(6199));module.exports=r})();