"use strict";(()=>{var e={};e.id=670,e.ids=[670,660],e.modules={7902:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{config:()=>x,default:()=>p,getServerSideProps:()=>g,getStaticPaths:()=>m,getStaticProps:()=>h,reportWebVitals:()=>v,routeModule:()=>_,unstable_getServerProps:()=>S,unstable_getServerSideProps:()=>y,unstable_getStaticParams:()=>b,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>f});var a=s(7093),i=s(5244),l=s(1323),n=s(9209),d=s.n(n),o=s(9597),c=s(7033),u=e([c]);c=(u.then?(await u)():u)[0];let p=(0,l.l)(c,"default"),h=(0,l.l)(c,"getStaticProps"),m=(0,l.l)(c,"getStaticPaths"),g=(0,l.l)(c,"getServerSideProps"),x=(0,l.l)(c,"config"),v=(0,l.l)(c,"reportWebVitals"),f=(0,l.l)(c,"unstable_getStaticProps"),j=(0,l.l)(c,"unstable_getStaticPaths"),b=(0,l.l)(c,"unstable_getStaticParams"),S=(0,l.l)(c,"unstable_getServerProps"),y=(0,l.l)(c,"unstable_getServerSideProps"),_=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/meetups",pathname:"/meetups",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:c});r()}catch(e){r(e)}})},7159:(e,t,s)=>{s.d(t,{a:()=>useAuth});var r=s(6689);function useAuth(){let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=localStorage.getItem("corks_token");e&&(t(e),fetch("/api/auth/me",{headers:{Authorization:"Bearer "+e}}).then(e=>e.json()).then(e=>{e&&!e.error&&a(e)}))},[]),{token:e,user:s,login:function(e,s){localStorage.setItem("corks_token",e),t(e),a(s)},logout:function(){localStorage.removeItem("corks_token"),t(null),a(null)}}}},7033:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>Meetups});var a=s(997),i=s(6689),l=s(7159),n=s(8933),d=s(5941),o=e([d]);d=(o.then?(await o)():o)[0];let fetcher=e=>fetch(e).then(e=>e.json());function Meetups(){let{data:e,mutate:t}=(0,d.default)("/api/meetups",fetcher,{refreshInterval:0}),s=(0,l.a)(),[r,o]=(0,i.useState)(""),[c,u]=(0,i.useState)("");async function create(){if(!r||!c)return alert("请输入标题和酒吧");let e=await fetch("/api/meetups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r,bar:c})}),s=await e.json();o(""),u(""),t(),alert("已创建："+(s.title||""))}return(0,a.jsxs)(n.Z,{children:[(0,a.jsxs)("div",{style:{display:"flex",gap:16,alignItems:"center"},children:[(0,a.jsxs)("div",{style:{flex:1},children:[a.jsx("h2",{children:"聚会列表"}),a.jsx("div",{className:"muted",children:"查看附近 / 推荐 / 即将开始的聚会"})]}),(0,a.jsxs)("div",{style:{width:380},className:"card",children:[a.jsx("div",{style:{fontWeight:800},children:"创建聚会"}),(0,a.jsxs)("div",{style:{marginTop:10},children:[a.jsx("input",{placeholder:"活动标题",value:r,onChange:e=>o(e.target.value),style:{width:"100%",padding:8,borderRadius:8,border:"1px solid rgba(255,255,255,0.03)",marginBottom:8}}),a.jsx("input",{placeholder:"酒吧（示例：Amber Bar）",value:c,onChange:e=>u(e.target.value),style:{width:"100%",padding:8,borderRadius:8,border:"1px solid rgba(255,255,255,0.03)",marginBottom:8}}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"btn",onClick:create,children:"创建"})})]})]})]}),a.jsx("div",{style:{marginTop:18},children:e?a.jsx("div",{className:"grid",children:e.map(e=>(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsxs)("div",{children:[a.jsx("div",{style:{fontWeight:800},children:e.title}),(0,a.jsxs)("div",{className:"muted small",children:[e.bar," • ",e.time||"待定"]})]}),(0,a.jsxs)("div",{style:{textAlign:"right"},children:[(0,a.jsxs)("div",{className:"badge",children:[e.attendees,"/",e.capacity]}),a.jsx("div",{style:{marginTop:8},children:a.jsx("button",{className:"small btn",onClick:async()=>{if(!s.user)return alert("请先登录再报名");let r=await fetch(`/api/meetups/${e.id}/rsvp`,{method:"POST",headers:{Authorization:"Bearer "+(s.token||"")}});if(r.ok)t(),alert("已报名");else{let e=await r.json();alert(JSON.stringify(e))}},children:"报名"})})]})]}),(0,a.jsxs)("div",{style:{marginTop:8},className:"muted small",children:["标签：",(e.tags||[]).join(" \xb7 ")]})]},e.id))}):a.jsx("div",{className:"muted",children:"加载中…"})})]})}r()}catch(e){r(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},9955:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[209,130,424,909],()=>__webpack_exec__(7902));module.exports=s})();